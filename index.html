<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <link rel="manifest" href="manifest.json" />
    <meta name="msapplication-navbutton-color" content="#2b2b2b" />
    <link rel="apple-touch-icon" href="icon-192.png" />
    <title>Flashcards App</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h1>Flashcards</h1>

    <!-- Chá»n nhÃ³m tháº» -->
    <div class="category-select-wrapper">
      <label for="categorySelect">âœï¸</label>
      <select id="categorySelect"></select>
      <button id="addCategoryBtn">â•</button>
    </div>

    <!-- Lá»c tháº» -->
    <div class="filter-wrapper">
      <label>
        <input type="checkbox" id="showUnlearnedOnly" />
        Chá»‰ hiá»ƒn thá»‹ tháº» chÆ°a há»c
      </label>
    </div>

    <!-- Tháº» -->
    <div id="flashcard" class="card">Nháº¥n Ä‘á»ƒ láº­t</div>
    <div id="cardCounter" class="counter">0 / 0</div>
    <div id="sliderContainer">
      <input
        type="range"
        id="slider"
        min="0"
        value="0"
        step="1"
        title="Adjust the slider"
      />
    </div>

    <!-- NÃºt chuyá»ƒn tháº» -->
    <div class="controls">
      <button id="prevBtn">â†</button>
      <button id="nextBtn">â†’</button>
    </div>

    <!-- NÃºt thao tÃ¡c tháº» -->
    <div class="action-buttons">
      <button id="addBtn">â•</button>
      <button id="editBtn">âœï¸</button>
      <button id="deleteBtn">ğŸ—‘</button>
      <button id="themeToggleBtn">ğŸŒ™/â˜€ï¸</button>

      <!-- Export / Import data.json -->
      <button id="exportBtn" title="Táº£i data.json">â¬‡ï¸ Export</button>
      <button id="importBtn" title="Táº£i lÃªn data.json">â¬†ï¸ Import</button>
      <input
        id="importInput"
        type="file"
        accept=".json"
        style="display: none"
      />
    </div>

    <!-- Form modal -->
    <div class="modal hidden" id="formModal">
      <div class="modal-content">
        <h3 id="formTitle">ThÃªm tháº»</h3>
        <textarea id="frontInput" placeholder="Máº·t trÆ°á»›c" rows="5"></textarea>
        <textarea id="backInput" placeholder="Máº·t sau" rows="5"></textarea>
        <div class="controls">
          <button id="saveBtn">ğŸ’¾ LÆ°u</button>
          <button id="cancelBtn">âŒ</button>
        </div>
      </div>
    </div>

    <!-- Form thÃªm nhÃ³m -->
    <div class="modal hidden" id="categoryModal">
      <div class="modal-content">
        <h3>ThÃªm nhÃ³m tháº»</h3>
        <input id="categoryNameInput" placeholder="TÃªn nhÃ³m" />
        <div class="controls">
          <button id="saveCategoryBtn">ğŸ’¾ LÆ°u</button>
          <button id="cancelCategoryBtn">âŒ Há»§y</button>
        </div>
      </div>
    </div>

    <script>
      // TEMP: unregister all SWs + clear caches (dÃ¹ng Ä‘á»ƒ debug, xÃ³a sau khi xong)
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.getRegistrations().then((regs) => {
          regs.forEach((r) => r.unregister());
          console.log('SW: unregistered', regs);
        });
      }
      if ('caches' in window) {
        caches.keys().then((keys) => {
          keys.forEach((k) => caches.delete(k));
          console.log('Caches cleared');
        });
      }
    </script>
    <!-- sau Ä‘Ã³ pháº§n Ä‘Äƒng kÃ½ SW hiá»‡n táº¡i -->
    <script src="app.js"></script>
    <script>
      // ÄÄƒng kÃ½ service worker
      /*
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker
          .register('./service-worker.js')
          .then((reg) => {
            console.log('Service Worker Ä‘Äƒng kÃ½ thÃ nh cÃ´ng:', reg.scope);
          })
          .catch((err) => {
            console.log('ÄÄƒng kÃ½ Service Worker tháº¥t báº¡i:', err);
          });
      }
          */

      if ('serviceWorker' in navigator) {
        navigator.serviceWorker
          .register('./service-worker.js')
          .then(() => console.log('âœ… SW Ä‘Äƒng kÃ½ thÃ nh cÃ´ng'))
          .catch((err) => console.error('âŒ SW lá»—i:', err));
      }
    </script>
  </body>
</html>
